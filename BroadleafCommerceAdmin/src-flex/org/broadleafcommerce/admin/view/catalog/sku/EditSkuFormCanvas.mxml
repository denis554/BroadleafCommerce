<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas 
	xmlns:mx="http://www.adobe.com/2006/mxml"
	width="100%"
	defaultButton="{this.saveButton}"
	creationComplete="handleCreationComplete()">
	<mx:Script>
		<![CDATA[
			import org.broadleafcommerce.admin.control.events.catalog.sku.SaveCatalogSkuEvent;
			import org.broadleafcommerce.admin.model.data.remote.catalog.sku.Sku;
			
			[Bindable]
			public var sku:Sku;
			
			private function handleCreationComplete():void{
				this.nameTextInput.setFocus();
			}
			
			private function handleSave(event:Event):void{
				if(this.sku == null){
					this.saveSku(this.bindFieldsToSku(new Sku()));
				}else{
					this.saveSku(this.bindFieldsToSku(this.sku));
				}
			}

			private function bindFieldsToSku(sku:Sku):Sku{
				sku.name = this.nameTextInput.text;
				sku.description = this.descriptionTextInput.text;
				sku.longDescription = this.descriptionTextInput.text;
				sku.activeStartDate = this.activeStartDateDateField.selectedDate;
				sku.activeEndDate = this.activeEndDateDateField.selectedDate;
				return sku;
			}
			
			private function saveSku(sku:Sku):void{
				var scse:SaveCatalogSkuEvent = new SaveCatalogSkuEvent(sku);
				scse.dispatch();
			}
		]]>
	</mx:Script>
	<mx:DateFormatter
		id="dateFormatter"/>
	<mx:StringValidator
		id="retailPriceStringValidator"
		property="text"
		source="{this.retailPriceTextInput}"
		required="true"/>
	<mx:StringValidator
		id="nameStringValidator"
		property="text"
		source="{this.nameTextInput}"
		required="true"/>
	<mx:Form
		id="newSkuForm">
		<mx:FormItem
			label="Name:">
			<mx:TextInput
				id="nameTextInput"
				text="{this.sku.name}"/>
		</mx:FormItem>
		<mx:FormItem
			label="Description:">
			<mx:TextInput
				id="descriptionTextInput"
				text="{this.sku.description}"/>
		</mx:FormItem>
		<mx:FormItem
			label="Long Description:">
			<mx:TextInput
				id="longDescriptionTextInput"
				text="{this.sku.longDescription}"/>
		</mx:FormItem>
		<mx:FormItem
			label="Sale Price:">
			<mx:TextInput
				id="salePriceTextInput"
				text="{this.sku.salePrice}"/>
		</mx:FormItem>
		<mx:FormItem
			label="Retail Price:">
			<mx:TextInput
				id="retailPriceTextInput"
				text="{this.sku.retailPrice}"/>
		</mx:FormItem>
		<mx:FormItem
			label="Taxable:">
			<mx:TextInput
				id="taxableTextInput"
				text="{this.sku.taxable}"/>
		</mx:FormItem>
		<mx:FormItem
			label="Discountable:">
			<mx:TextInput
				id="discountableTextInput"
				text="{this.sku.discountable}"/>
		</mx:FormItem>
		<mx:FormItem
			label="Available:">
			<mx:TextInput
				id="availableTextInput"
				text="{this.sku.available}"/>
		</mx:FormItem>
		<mx:FormItem
			label="Active Start Date:">
			<mx:DateField
				id="activeStartDateDateField"
				selectedDate="{this.sku.activeStartDate}"/>
		</mx:FormItem>
		<mx:FormItem
			label="Active End Date:">
			<mx:DateField
				id="activeEndDateDateField"
				selectedDate="{this.sku.activeEndDate}"/>
		</mx:FormItem>
		<mx:FormItem>
			<mx:Button 
				id="saveButton"
				label="Save"
				click="handleSave(event)"/>
		</mx:FormItem>
	</mx:Form>
</mx:Canvas>