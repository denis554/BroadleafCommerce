!function(t){"use strict";function i(i,o){this.settings=t.extend({},e,o),this.modal=i,this.buildDOM(),this.addEventListeners(),this.index=t[s].lookup.push(this)-1,this.busy=!1}var s="remodal",e={hashTracking:!0,closeOnConfirm:!0,closeOnCancel:!0};t[s]={lookup:[]};var o,n,a=function(t){var i=t.css("transition-duration")||t.css("-webkit-transition-duration")||t.css("-moz-transition-duration")||t.css("-o-transition-duration")||t.css("-ms-transition-duration")||0,s=t.css("transition-delay")||t.css("-webkit-transition-delay")||t.css("-moz-transition-delay")||t.css("-o-transition-delay")||t.css("-ms-transition-delay")||0;return 1e3*(parseFloat(i)+parseFloat(s))},d=function(){if(t(document.body).height()<=t(window).height())return 0;var i=document.createElement("div");i.style.visibility="hidden",i.style.width="100px",document.body.appendChild(i);var s=i.offsetWidth;i.style.overflow="scroll";var e=document.createElement("div");e.style.width="100%",i.appendChild(e);var o=e.offsetWidth;return i.parentNode.removeChild(i),s-o},r=function(){t(document.body).css("padding-right","+="+d()),t("html, body").addClass(s+"_lock")},l=function(){t(document.body).css("padding-right","-="+d()),t("html, body").removeClass(s+"_lock")},c=function(t){var i,s,e={};i=t.replace(/\s*:\s*/g,":").replace(/\s*,\s*/g,","),s=i.split(",");var o,n,a;for(o=0,n=s.length;n>o;o++)s[o]=s[o].split(":"),a=s[o][1],("string"==typeof a||a instanceof String)&&(a="true"===a||("false"===a?!1:a)),("string"==typeof a||a instanceof String)&&(a=isNaN(a)?a:+a),e[s[o][0]]=a;return e};i.prototype.buildDOM=function(){this.body=t(document.body),this.bg=t("."+s+"-bg"),this.modalClose=t("<a href='#'>").addClass(s+"-close"),this.overlay=t("<div>").addClass(s+"-overlay"),this.modal.hasClass(s)||this.modal.addClass(s),this.modal.css("visibility","visible"),this.modal.append(this.modalClose),this.overlay.append(this.modal),this.body.append(this.overlay),this.confirm=this.modal.find("."+s+"-confirm"),this.cancel=this.modal.find("."+s+"-cancel");var i=a(this.overlay),e=a(this.modal),o=a(this.bg);this.td=e>i?e:i,this.td=o>this.td?o:this.td},i.prototype.addEventListeners=function(){var i=this;this.modalClose.bind("click."+s,function(t){t.preventDefault(),i.close()}),this.cancel.bind("click."+s,function(t){t.preventDefault(),i.modal.trigger("cancel"),i.settings.closeOnCancel&&i.close()}),this.confirm.bind("click."+s,function(t){t.preventDefault(),i.modal.trigger("confirm"),i.settings.closeOnConfirm&&i.close()}),t(document).bind("keyup."+s,function(t){27===t.keyCode&&i.close()}),this.overlay.bind("click."+s,function(e){var o=t(e.target);o.hasClass(s+"-overlay")&&i.close()})},i.prototype.open=function(){if(!this.busy){this.busy=!0,this.modal.trigger("open");var i=this.modal.attr("data-"+s+"-id");i&&this.settings.hashTracking&&(n=t(window).scrollTop(),location.hash=i),o&&o!==this&&(o.overlay.hide(),o.body.removeClass(s+"_active")),o=this,r(),this.overlay.show();var e=this;setTimeout(function(){e.body.addClass(s+"_active"),setTimeout(function(){e.busy=!1,e.modal.trigger("opened")},e.td+50)},25)}},i.prototype.close=function(){if(!this.busy){this.busy=!0,this.modal.trigger("close"),this.settings.hashTracking&&this.modal.attr("data-"+s+"-id")===location.hash.substr(1)&&(location.hash="",t(window).scrollTop(n)),this.body.removeClass(s+"_active");var i=this;setTimeout(function(){i.overlay.hide(),l(),i.busy=!1,i.modal.trigger("closed")},i.td+50)}},t&&(t.fn[s]=function(e){var o;return this.each(function(n,a){var d=t(a);null==d.data(s)&&(o=new i(d,e),d.data(s,o.index),o.settings.hashTracking&&d.attr("data-"+s+"-id")===location.hash.substr(1)&&o.open())}),o}),t(document).ready(function(){t(document).on("click","[data-"+s+"-target]",function(i){i.preventDefault();var e=i.currentTarget,o=e.getAttribute("data-"+s+"-target"),n=t("[data-"+s+"-id="+o+"]");t[s].lookup[n.data(s)].open()}),t(document).find("."+s).each(function(i,e){var o=t(e),n=o.data(s+"-options");n?("string"==typeof n||n instanceof String)&&(n=c(n)):n={},o[s](n)})});var h=function(i,e){var n=location.hash.replace("#","");if("undefined"==typeof e&&(e=!0),n){var a;try{a=t("[data-"+s+"-id="+n.replace(new RegExp("/","g"),"\\/")+"]")}catch(i){}if(a&&a.length){var d=t[s].lookup[a.data(s)];d&&d.settings.hashTracking&&d.open()}}else e&&o&&!o.busy&&o.settings.hashTracking&&o.close()};t(window).bind("hashchange."+s,h)}(window.jQuery||window.Zepto);