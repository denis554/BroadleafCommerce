<div>
    <form th:fragment="form" action="#" th:action="@{resetPassword}" method="post" class="form-horizontal" th:object="${resetPasswordForm}">
        <div class="control-group">
            <label class="control-label" for="username">Username</label>
            <div class="controls">
                <input type="text" id="username" name="username" th:field="*{username}" autofocus="autofocus" />
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="token">Token</label>
            <div class="controls">
                <input type="text" id="token" name="token" th:field="*{token}" />
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="password">New Password</label>
            <div class="controls">
                <input type="password" id="password" name="password" th:field="*{password}" />
            </div>
        </div>
        <div class="control-group">
            <label class="control-label" for="confirmPassword">Confirm New Password</label>
            <div class="controls">
                <input type="password" id="confirmPassword" name="confirmPassword" th:field="*{confirmPassword}" />
            </div>
        </div>
        <div class="control-group">
            <div class="controls">
                <button type="submit" class="btn" >Reset Password</button>
            </div>
        </div>
    </form>
    <div th:fragment="messages">
        <p th:if="${errorCode == 'notFound'}" class="alert alert-error"><strong>No matching user found.</strong></p>
        <p th:if="${errorCode == 'inactiveUser'}" class="alert alert-error"><strong>The username associated with the email you entered is marked as inactive.   Please contact an administrator to activate the account.</strong></p>
        <p th:if="${errorCode == 'invalidToken'} or ${errorCode == 'tokenExpired'}" class="alert alert-error"><strong>The token entered is invalid or expired.     To request a new token, choose the "Forgot Password" link below.</strong></p>
        <p th:if="${errorCode == 'tokenUsed'}" class="alert alert-error"><strong>The token entered has already been processed.   No new updates were made.   To request a new token, choose the "Forgot Password" link below.</strong></p>
        <p th:if="${errorCode == 'inactiveUser'}" class="alert alert-error"><strong>The username associated with the email you entered is marked as inactive.   Please contact an administrator to activate the account.</strong></p>
        <p th:if="${errorCode == 'invalidPassword'}" class="alert alert-error"><strong>Please enter a valid password.</strong></p>
        <p th:if="${errorCode == 'passwordMismatch'}" class="alert alert-error"><strong>The password and confirm password fields did not match.</strong></p>
        <p th:if="${param.messageCode == 'passwordTokenSent'}" class="alert alert-success"><strong>A reset password email was sent to the address associated with your account.  Enter the token from your email in the form below to reset your password.</strong></p>
    </div>
    <div th:fragment="options">
        <a href="#" th:href="@{login}">Login</a> |
        <a href="#" th:href="@{forgotUsername}">Forgot Username</a> |
        <a href="#" th:href="@{forgotPassword}">Forgot Password</a>
    </div>
</div>